<ng-container *ngIf="!loading; else loadingState">
  <header>
    <nz-select
      [(ngModel)]="version"
      (ngModelChange)="emitRefresh($event)">
      <nz-option
        *ngFor="let item of versionNames"
        [nzLabel]="item"
        [nzValue]="item"
      />
    </nz-select>
    <button nz-button (click)="emitRefresh(version)">
      <i nz-icon nzType="reload" nzTheme="outline"></i>
    </button>
  </header>
  <nz-tree
    *ngIf="nodes.length; else emptyState"
    nzBlockNode
    [nzData]="nodes"
    [nzTreeTemplate]="nzTreeTemplate">
  </nz-tree>
</ng-container>

<ng-template #nzTreeTemplate let-node let-origin="origin">
  <span class="node">
    <span *ngIf="!node.isLeaf" (contextmenu)="contextMenu($event, menu, node)">
      <i nz-icon [nzType]="node.isExpanded ? 'folder-open' : 'folder'"></i>
      <span class="folder-name">{{ node.title }}</span>
    </span>
    <span *ngIf="node.isLeaf" (contextmenu)="contextMenu($event, menu, node)">
      <i nz-icon nzType="file"></i>
      <span class="file-name">{{ node.title }}</span>
    </span>
  </span>
</ng-template>

<nz-dropdown-menu #menu="nzDropdownMenu">
  <ul nz-menu>
    <li nz-menu-item (click)="download()">Télécharger</li>
    <li nz-menu-item (click)="copyPath()">Copier le chemin</li>
  </ul>
</nz-dropdown-menu>

<ng-template #emptyState>
  <nz-empty nzNotFoundImage="simple" [nzNotFoundContent]="content">
    <ng-template #content>
      <p>Aucun fichier à afficher</p>
    </ng-template>
  </nz-empty>
</ng-template>

<ng-template #loadingState>
  <nz-spin nzSimple nzSize="large"></nz-spin>
</ng-template>
